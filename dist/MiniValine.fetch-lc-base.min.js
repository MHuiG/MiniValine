(window.webpackJsonpMiniValine=window.webpackJsonpMiniValine||[]).push([[7],{44:function(e,n,o){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.FetchLCBase=function(e){e.setAV=function(e){var n,o="https://";if(!e.config.serverURLs)switch(e.config.appId.slice(-9)){case"-9Nh9j0Va":o+="tab.leancloud.cn";break;case"-MdYXbMMI":o+="console.leancloud.app";break;default:o+="avoscloud.com"}n=e.config.serverURLs||o;try{AV.init({appId:e.config.appId,appKey:e.config.appKey,serverURLs:n})}catch(e){}e.v=AV},e.fetchCount=function(e){var n=new e.v.Query("Comment");n.equalTo("url",e.C.url);var o=new e.v.Query("Comment");o.equalTo("url","".concat(e.C.url,"/"));var t=AV.Query.or(n,o);t.notEqualTo("isSpam",!0),t.count().then((function(n){e.el.querySelector(".count").innerHTML=n})).catch((function(n){console.log(n),e.el.querySelector(".count").innerHTML=0}))},e.fetchParentList=function(e,n,o){e.v.Query.doCloudQuery("select nick, comment, link, rid, isSpam, mailMd5, ua ".concat(e.config.region?",log":""," from Comment where (rid='' or rid is not exists) and (url='").concat(e.C.url,"' or url='","".concat(e.C.url,"/"),"') order by -createdAt limit ").concat((n-1)*e.pageSize,",").concat(e.pageSize)).then((function(e){o(e)})).catch((function(n){e.loading.hide(e.parentCount)}))},e.fetchParentCount=function(e,n){e.v.Query.doCloudQuery("select count(*) from Comment where (rid='' or rid is not exists) and (url='".concat(e.C.url,"' or url='","".concat(e.C.url,"/"),"') order by -createdAt")).then((function(e){n(e)})).catch((function(e){console.log(e)}))},e.fetchNextList=function(e,n,o){e.v.Query.doCloudQuery("select nick, comment, link, rid, isSpam, mailMd5, ua ".concat(e.config.region?",log":""," from Comment where rid='").concat(n,"' and (url='").concat(e.C.url,"' or url='","".concat(e.C.url,"/"),"') order by -createdAt")).then((function(e){o(e)})).catch((function(n){e.loading.hide(e.parentCount)}))},e.fetchNextCount=function(e,n,o){e.v.Query.doCloudQuery("select count(*) from Comment where rid='".concat(n,"' and (url='").concat(e.C.url,"' or url='","".concat(e.C.url,"/"),"') order by -createdAt")).then((function(e){o(e)})).catch((function(e){console.log(e)}))},e.postComment=function(e,n){var o,t=new(e.v.Object.extend("Comment"));for(var c in e.C)if(e.C.hasOwnProperty(c)){if("at"===c)continue;var r=e.C[c];t.set(c,r)}t.setACL(((o=new e.v.ACL).setWriteAccess("role:"+e.role,!0),o.setPublicReadAccess(!0),o.setPublicWriteAccess(!1),o)),t.save({log:window.MV}).then((function(e){n(e)})).catch((function(n){e.submitting.hide()}))}}}}]);