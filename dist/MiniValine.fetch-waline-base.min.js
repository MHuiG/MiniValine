(self.webpackChunkMiniValine=self.webpackChunkMiniValine||[]).push([[864],{306:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FetchBase=function(e){var t="".concat(e.config.serverURLs,"/comment");e.fetchCount=function(e){(0,n.default)({url:t,type:"GET",data:{type:"count",url:e.config.pathname},success:function(t){e.el.querySelector(".count").innerHTML=t}})},e.fetchTotalPages=function(e,i){(0,n.default)({url:t,type:"GET",data:{path:e.config.pathname,pageSize:e.pageSize,page:1},success:function(e){window.MV.WalinePageData=e,i(e.totalPages)}})},e.fetchParentList=function(e,i,s){if(1==i){var r=new a.default;window.MV.WalinePageList=r.beanList(window.MV.WalinePageData.data),s(window.MV.WalinePageList)}else(0,n.default)({url:t,type:"GET",data:{path:e.config.pathname,pageSize:e.pageSize,page:i},success:function(e){window.MV.WalinePageData=e;var t=new a.default;window.MV.WalinePageList=t.beanList(e.data),s(window.MV.WalinePageList)}})},e.fetchNextList=function(e,t,i){for(var n=[],a=window.MV.WalinePageList,s=0;s<a.length;s++)if(a[s].children)for(var r=0;r<a[s].children.length;r++)t==a[s].children[r].rid&&n.push(a[s].children[r]);i(n)},e.fetchNextCount=function(e,t,i){for(var n=[],a=window.MV.WalinePageList,s=0;s<a.length;s++)if(a[s].children)for(var r=0;r<a[s].children.length;r++)t==a[s].children[r].rid&&n.push(a[s].children[r]);n.length>0&&i(1)},e.postComment=function(e,i){var s=new a.default;for(var r in e.C)if(e.C.hasOwnProperty(r)){var c=e.C[r];"at"===r&&(c=c.substr(1)),s.set(r,c)}var o=Object.create(null);if((o={comment:s.comment,link:s.link,mail:s.mail,nick:s.nick,ua:s.ua,url:s.url,at:s.at}).at){var l=JSON.parse(window.atob(document.querySelector("#comment-"+s.rid+" .comment-item").textContent));l.pid?o.rid=l.pid:o.rid=l.id,o.pid=l.id}(0,n.default)({url:t,type:"POST",data:o,success:function(e){var t=new a.default;t.create(e.data),i(t)}})}};var n=s(i(4460)),a=s(i(6818));function s(e){return e&&e.__esModule?e:{default:e}}},6818:e=>{"use strict";e.exports=function e(){this.set=function(e,t){this[e]=t},this.get=function(e){return this[e]},this.create=function(t){this.set("nick",t.nick),this.set("mailMd5",t.mail),this.set("link",t.link),this.set("createdAt",new Date(t.insertedAt)),this.set("id",t.objectId),this.set("rid",t.pid),this.set("pid",t.rid),this.set("browser",t.browser),this.set("os",t.os),this.set("comment",t.comment);var i=new e;this.set("children",i.beanList(t.children))},this.beanList=function(t){var i=[];if(t&&t.length)for(var n=0;n<t.length;n++){var a=new e;a.create(t[n]),i.push(a)}return i}}}}]);