(window.webpackJsonpMiniValine=window.webpackJsonpMiniValine||[]).push([[9],{46:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FetchBase=FetchBase;var _ajax=__webpack_require__(2),_ajax2=_interopRequireDefault(_ajax),_Bean=__webpack_require__(74),_Bean2=_interopRequireDefault(_Bean);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function FetchBase(root){var url="".concat(root.config.serverURLs,"/comment");root.fetchCount=function(e){(0,_ajax2.default)({url:url,type:"GET",data:{type:"count",url:e.config.pathname},success:function(t){e.el.querySelector(".count").innerHTML=t}})},root.fetchTotalPages=function(root,callback){(0,_ajax2.default)({url:url,type:"GET",data:{path:root.config.pathname,pageSize:root.pageSize,page:1},success:function success(data){data=eval("("+data+")"),window.MV.WalinePageData=data,callback(data.totalPages)}})},root.fetchParentList=function(root,pageNum,callback){if(1==pageNum){var item=new _Bean2.default;window.MV.WalinePageList=item.beanList(window.MV.WalinePageData.data),callback(window.MV.WalinePageList)}else(0,_ajax2.default)({url:url,type:"GET",data:{path:root.config.pathname,pageSize:root.pageSize,page:pageNum},success:function success(data){data=eval("("+data+")"),window.MV.WalinePageData=data;var item=new _Bean2.default;window.MV.WalinePageList=item.beanList(data.data),callback(window.MV.WalinePageList)}})},root.fetchNextList=function(e,t,a){for(var i=[],n=window.MV.WalinePageList,r=0;r<n.length;r++)if(n[r].children)for(var o=0;o<n[r].children.length;o++)t==n[r].children[o].rid&&i.push(n[r].children[o]);a(i)},root.fetchNextCount=function(e,t,a){for(var i=[],n=window.MV.WalinePageList,r=0;r<n.length;r++)if(n[r].children)for(var o=0;o<n[r].children.length;o++)t==n[r].children[o].rid&&i.push(n[r].children[o]);i.length>0&&a(1)},root.postComment=function(root,callback){var item=new _Bean2.default;for(var i in root.C)if(root.C.hasOwnProperty(i)){var _v=root.C[i];"at"===i&&(_v=_v.substr(1)),item.set(i,_v)}item.set("createdAt",new Date);var data=Object.create(null);if(data={comment:item.comment,link:item.link,mail:item.mail,nick:item.nick,ua:item.ua,url:item.url,at:item.at},data.at){var parentNode=JSON.parse(window.atob(document.querySelector("#comment-"+item.rid+" .comment-item").textContent));parentNode.pid?data.rid=parentNode.pid:data.rid=parentNode.id,data.pid=parentNode.id}(0,_ajax2.default)({url:url,type:"POST",data:data,success:function success(data){data=eval("("+data+")");var item=new _Bean2.default;item.create(data.data),callback(item)}})}}},74:function(e,t,a){"use strict";e.exports=function e(){this.set=function(e,t){this[e]=t},this.get=function(e){return this[e]},this.create=function(t){this.set("nick",t.nick),this.set("mailMd5",t.mail),this.set("link",t.link),this.set("createdAt",new Date(t.createdAt)),this.set("id",t.objectId),this.set("rid",t.pid),this.set("pid",t.rid),this.set("browser",t.browser),this.set("os",t.os),this.set("comment",t.comment);var a=new e;this.set("children",a.beanList(t.children))},this.beanList=function(t){var a=[];if(t&&t.length)for(var i=0;i<t.length;i++){var n=new e;n.create(t[i]),a.push(n)}return a}}}}]);